upfrontrjs.define([],function(){var t=function(t){if(Array.prototype.reduce)return t.split("").reduce(function(t,e){return(t=(t<<5)-t+e.charCodeAt(0))&t},0);var e=0;if(0===t.length)return e;for(var r=0;r<this.length;r++){e=(e<<5)-e+t.charCodeAt(r),e&=e}return e};return{get_storage_id:function(){return"_upfront_cache"},get_hash:function(e){return e?""+t(e):""},get_storage:function(){return{}},set_storage:function(t){return!0},get_valid_key:function(t){return!!t&&("string"!=typeof t&&(t=this.get_hash(JSON.stringify(t))),!(t.length>128)&&t)},set:function(t,e,r){if(!(t=this.get_valid_key(t)))return!1;r=r||"general";var n=this.get_storage();return n[r]=n[r]||{},n[r][t]=e,this.set_storage(n)},has:function(t,e){if(!(t=this.get_valid_key(t)))return!1;e=e||"general";var r=this.get_storage();return r[e]=r[e]||{},!!(t in r[e])},unset:function(t,e){if(!(t=this.get_valid_key(t)))return!1;if(e=e||"general",!this.has(t,e))return!1;var r=this.get_storage();return r[e]=r[e]||{},delete r[e][t],this.set_storage(r)},purge:function(){return Upfront.Util.log("Purging all caches"),this.set_storage({})},purge_bucket:function(t){t=t||"general";var e=this.get_storage();return e[t]=e[t]||{},e[t]={},this.set_storage(e)},get:function(t,e){if(!(t=this.get_valid_key(t)))return!1;if(e=e||"general",!this.has(t,e))return!1;var r=this.get_storage();return r[e]=r[e]||{},r[e][t]},listen:function(){return this.stop_listening(),Upfront.Events.on("upfront:cache:purge",this.purge,this),this._is_listening=!0,!0},stop_listening:function(){return Upfront.Events.off("upfront:cache:purge",this.purge),this._is_listening=!1,!0},is_listening:function(){return!!this._is_listening}}});